<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The finite volume method &mdash; FVM Docs 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="FVM Docs 0.1 documentation" href="index.html" />
    <link rel="prev" title="Notes on implemented the finite-volume method for the advection-diffusion equation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="Notes on implemented the finite-volume method for the advection-diffusion equation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">FVM Docs 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-finite-volume-method">
<h1>The finite volume method<a class="headerlink" href="#the-finite-volume-method" title="Permalink to this headline">¶</a></h1>
<p>The advection-diffusion equation with non-linear source term, in flux form, is given by,</p>
<div class="math">
\[u_t = (\mathcal{-F})_x + s(t,x,u)\]</div>
<p>where <span class="math">\(\mathcal{F} = au - du_x\)</span>. This expression holds over the whole domain, therefore it must also hold over a subdomain <span class="math">\(\Omega_j=(x_{j-1/2}, x_{j+1/2})\)</span>. Integrating over the subdomain, or cell, gives,</p>
<div class="math">
\[\int_{x_{j-1/2}}^{x_{j+1/2}} u_t~dx = \int_{x_{j-1/2}}^{x_{j+1/2}} (\mathcal{-F})_x~dx + \int_{x_{j-1/2}}^{x_{j+1/2}} s(x,t,u)~dx\]</div>
<p>If we now use <span class="math">\(w\)</span> to represent the cell averages then we don&#8217;t have to perform the actual integrations,</p>
<div class="math">
\[w_j^{\prime} =  -\frac{\mathcal{F}_{j+1/2}}{h_j} + \frac{\mathcal{F}_{j-1/2}}{h_{j}} + \bar{s}_j\]</div>
<p>Using linear interpolation (see the next section) to determine the fluxes at the cell faces,</p>
<div class="math">
\[\mathcal{F}_{j+\frac{1}{2}} = a_{j+\frac{1}{2}}\left( \frac{h_{j+1}}{2h_{+}} w_j + \frac{h_j}{2h_{+}} w_{j+1} \right) - d_{j+\frac{1}{2}} \frac{w_{j+1}-w_j}{h_{+}}\]</div>
<div class="math">
\[\mathcal{F}_{j-\frac{1}{2}} = a_{j-\frac{1}{2}}\left( \frac{h_{j}}{2h_{-}} w_{j-1} + \frac{h_{j-1}}{2h_{-}} w_{j} \right) - d_{j-\frac{1}{2}} \frac{w_{j}-w_{j-1}}{h_{-}}\]</div>
<p>The meaning of the &#8220;h&#8221; terms is shown in the figure below,</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/cells_FVM.png"><img alt="Finite volume cells with important distances and positions labelled." src="_images/cells_FVM.png" style="width: 405.0px; height: 174.0px;" /></a>
<p class="caption">Finite volume cells with important distances and positions labelled.</p>
</div>
<p>Substituting the definition of the fluxes into the above equation yields,</p>
<div class="math">
\[w_j^{\prime} = \frac{w_{j-1}}{h_j} \left( \frac{a(x_{j-\frac{1}{2}}) h_j}{2h_{-}} + \frac{d(x_{j-\frac{1}{2}})}{h_{-}}\right) + \frac{w_j}{h_j}\left( \frac{a(x_{j-\frac{1}{2}})h_{j-1}}{2h_{-}} - \frac{a(x_{j+\frac{1}{2}})h_{j+1}}{2h_{+}} -         \frac{d(x_{j-\frac{1}{2}})}{h_{-}} - \frac{d(x_{j+\frac{1}{2}})}{h_{+}}  \right) + \frac{w_{j+1}}{h_j} \left( \frac{-a(x_{j+\frac{1}{2}})h_j}{2h_{+}} + \frac{d(x_{j+\frac{1}{2}})}{h_{+}} \right)\]</div>
<p>This equation is the <em>semi-discrete</em> form.</p>
<div class="section" id="adaptive-upwinding-exponential-fitting">
<h2>Adaptive upwinding &amp; exponential fitting<a class="headerlink" href="#adaptive-upwinding-exponential-fitting" title="Permalink to this headline">¶</a></h2>
<p>Hundsdorfer (on pg. 266) notes that a adaptive upwinding scheme can be introduced by altering the diffusion coefficient,</p>
<div class="math">
\[d(x_{j}) \rightarrow d(x_{j}) + \frac{1}{2}\kappa_{j} h_{j} a(x_{j})\]</div>
<div class="math">
\[\kappa=\text{sgn}(a(x_{j})).\]</div>
<p>Here the nature of the discretisation is defined by the sign of the <span class="math">\(a\)</span>, when <span class="math">\(a\neq0\)</span> the scheme results in an upwind discretisation. Only if <span class="math">\(a=0\)</span> (corresponding to the diffusion equation limit) does the scheme become based on a central difference (see the red line in the Figure below). A generalisation is possible by choosing a function for <span class="math">\(\kappa\)</span> which automatically adjusts the discretisation method depending on the local value of Peclet&#8217;s number, <span class="math">\(\mu=ah/d\)</span>. Exponential fitting has shown to be a robust scheme for steady-state approaches. Exponential fitting can be introduced by,</p>
<div class="math">
\[\kappa = \frac{e^{\mu}+1}{e^{\mu}-1} - \frac{2}{\mu}\]</div>
<p>An approximation to the above, which does not require the evaluation of exponentials is commonly used,</p>
<div class="math">
\[\begin{split}\kappa = \begin{cases}
\text{max}(0, 1-2/\mu) &amp; \text{when}~ \mu&gt;0 \\
\text{min}(0, -1-2/\mu) &amp; \text{when}~ \mu&lt;0
\end{cases}\end{split}\]</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/Exponential_fitting_and_approximation.png"><img alt="Exponential fitting and approximation" src="_images/Exponential_fitting_and_approximation.png" style="width: 459.0px; height: 283.0px;" /></a>
</div>
<p>This is a very elegant want to introduce adaptive upwinding or exponential fitting because it can be brought into the discretisation in an ad hoc manner. Note that for all of the adaptive expressions <span class="math">\(\kappa\rightarrow\pm1\)</span> as <span class="math">\(\mu\rightarrow\pm\infty\)</span>, and <span class="math">\(\kappa\rightarrow 0\)</span> as <span class="math">\(\mu\rightarrow 0\)</span>. This means the discretisation will automatically weight in the favour of the upwind scheme in locations where advection dominates. Conversely, where diffusion dominates the weighting factor shifts in favour of a central difference scheme.</p>
</div>
<div class="section" id="naturally-resolved-robin-boundary-conditions">
<h2>Naturally resolved Robin boundary conditions<a class="headerlink" href="#naturally-resolved-robin-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://scicomp.stackexchange.com/questions/7650/how-should-boundary-conditions-be-applied-when-using-finite-volume-method">Within the finite volume method Robin boundary conditions are naturally resolved</a>. This means that there is no need for interpolation or ghost point substitution (although these approaches remain possible) to include the boundary conditions because the flux at the boundary appears naturally in the semi-discretised equation. For example consider the semi-discretised equation evaluated at the boundary cell <span class="math">\(\Omega_1\)</span>,</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/boundary_cell_FVM.png"><img alt="Finite volume boundary cell at the left hand side." src="_images/boundary_cell_FVM.png" style="width: 333.0px; height: 192.0px;" /></a>
<p class="caption">Finite volume boundary cell at the left hand side.</p>
</div>
<div class="math">
\[w_1^{\prime} =  -\frac{\mathcal{F}_{3/2}}{h_1} + \frac{\mathcal{F}_{1/2}}{h_{1}} + \bar{s}_1\]</div>
<p>The Robin boundary condition specifies the flux at <span class="math">\(x_{1/2}\)</span>,</p>
<div class="math">
\[\mathcal{F}_{1/2} = g_{R}(x_{1/2})\]</div>
<p>Therefore the boundary condition can be incorporated without invoking any information regarding the ghost cell,</p>
<div class="math">
\[w_1^{\prime} = \frac{w_1}{h_1}\left( \frac{-a(x_{3/2})h_{2}}{2h_{+}} - \frac{d(x_{3/2})}{h_{+}} \right) + \frac{w_{2}}{h_1} \left( \frac{-a(x_{3/2}) h_1}{2h_{+}} + \frac{d(x_{3/2})}{h_{+}} \right) + \frac{g_{R}(x_L)}{h_1} + \bar{s}_1\]</div>
<p>Similarly applying the same procedure to the <span class="math">\(\Omega_J\)</span> cell at the right hand side boundary,</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/boundary_cell_FVM_rhs.png"><img alt="Finite volume boundary cell at the right hand side." src="_images/boundary_cell_FVM_rhs.png" style="width: 304.0px; height: 191.0px;" /></a>
<p class="caption">Finite volume boundary cell at the right hand side.</p>
</div>
<div class="math">
\[w_J^{\prime} =  -\frac{\mathcal{F}_{J+1/2}}{h_J} + \frac{\mathcal{F}_{J-1/2}}{h_J} + \bar{s}_J\]</div>
<p>The Robin boundary condition at the right hand side is,</p>
<div class="math">
\[g_{R}(x_R) = \mathcal{F}_{J+1/2}\]</div>
<p>Therefore the naturally resolved boundary condition on the right hand side becomes,</p>
<div class="math">
\[w_J^{\prime} = \frac{w_{J-1}}{h_J}\left( \frac{a(x_{J-1/2})h_{J}}{2h_{-}} + \frac{d(x_{J-1/2})}{h_{-}} \right) + \frac{w_{J}}{h_J} \left( \frac{a(x_{J-1/2}) h_{J-1}}{2h_{-}} - \frac{d(x_{J-1/2})}{h_{-}} \right) - \frac{g_{R}(x_R)}{h_J} + \bar{s}_J\]</div>
</div>
<div class="section" id="the-method">
<h2>The <span class="math">\(\theta\)</span>-method<a class="headerlink" href="#the-method" title="Permalink to this headline">¶</a></h2>
<p>The <span class="math">\(\theta\)</span>-method is an approach which improves the stability and numerical accuracy when integrating a partial differential equation in time. It consists of writing the equation as the time average of the current and future time step. When <span class="math">\(\theta=0\)</span> a fully explicit scheme is recovered in which the future state of the system is derived purely from the current state. Conversely,  <span class="math">\(\theta=1\)</span> gives a fully implicit formalism, in which a linear system of equation is solved to determine the future state. Setting <span class="math">\(\theta=1/2\)</span> results in an average of these two limits and it is generally causes the the Crank-Nicolson method. Crank-Nicolson provides unconditionally stable iterations for the advection and diffusion equations, and the improves the time integration (it corresponds to a trapezium integration in the time domain).</p>
<div class="math">
\[\frac{w_j^{n+1} - w_j^n}{k} = \theta r_a w_{j-1}^{n+1} + (1 - \theta) r_a w_{j-1}^{n} + \theta r_b w_{j-1}^{n+1}  + (1 - \theta) r_b w_{j-1}^{n} +  \theta r_c w_{j-1}^{n+1}  + (1 - \theta) r_c w_{j-1}^{n} + \bar{s}_j^n\]</div>
<p>In the above <span class="math">\(k\)</span> stands for the difference in time, the <span class="math">\(n+1\)</span> are the terms at the future time point, and <span class="math">\(n\)</span> terms are the current time point. The &#8220;<span class="math">\(r\)</span>&#8221; terms are the coefficients of the semi-discretised equation. Moving the unknowns to the left hand side,</p>
<div class="math">
\[w_j^{n+1} - \theta k r_a w_{j-1}^{n+1} - \theta k r_b w_{j}^{n+1} - \theta k r_c w_{j+1}^{n+1} = w_j^{n} + (1 - \theta) k r_a w_{j-1}^{n} + (1 - \theta) k r_b w_{j}^{n} + (1 - \theta) k r_c w_{j1}^{n} + k \bar{s}_j^n\]</div>
<p>Defining the coefficients for to include the time step,</p>
<div class="math">
\[\begin{split}r_a &amp; = \frac{k}{h_j} \left( \frac{a(x_{j-\frac{1}{2}}) h_j}{2h_{-}}  + \frac{d(x_{j-\frac{1}{2}})}{h_{-}}\right) \\
r_b &amp; = \frac{k}{h_j}\left( \frac{a(x_{j-\frac{1}{2}})h_{j-1}}{2h_{-}} - \frac{a(x_{j+\frac{1}{2}})h_{j+1}}{2h_{+}} - \frac{d(x_{j-\frac{1}{2}})}{h_{-}} - \frac{d(x_{j+\frac{1}{2}})}{h_{+}}  \right)\\
r_c &amp; = \frac{k}{h_j} \left( \frac{-a(x_{j+\frac{1}{2}})h_j}{2h_{+}} + \frac{d(x_{j+\frac{1}{2}})}{h_{+}} \right)\end{split}\]</div>
</div>
<div class="section" id="discretised-equation-in-matrix-form">
<h2>Discretised equation in matrix form<a class="headerlink" href="#discretised-equation-in-matrix-form" title="Permalink to this headline">¶</a></h2>
<p>Here we present a general matrix equation,</p>
<div class="math">
\[\boldsymbol{A}\cdot\boldsymbol{w}^{n+1} = \boldsymbol{M}\cdot\boldsymbol{w}^{n} + \boldsymbol{s} + \boldsymbol{b}\]</div>
<p>for the discretisation of the advection-diffusion equation that can be easily modified to include Robin or Dirichlet boundary conditions.</p>
<p>Where the left hand side is,</p>
<div class="math">
\[\begin{split}\begin{align}
\begin{pmatrix}
b_1 &amp; c_1    &amp;        &amp;       &amp; 0   \\
a_2 &amp; 1-\theta r_b    &amp; -\theta r_c    &amp;       &amp;     \\
    &amp; \ddots &amp; \ddots &amp; \ddots&amp;     \\
    &amp;        &amp;  - \theta r_a   &amp; 1-\theta r_b   &amp; c_{J-1} \\
 0  &amp;        &amp;        &amp; a_J   &amp; b_J
\end{pmatrix}
\begin{pmatrix}
    w_1^{n+1} \\
    w_2^{n+1} \\
    \vdots \\
    w_{J-1}^{n+1} \\
    w_J^{n+1} \\
\end{pmatrix}
\end{align}\end{split}\]</div>
<p>and the right hand side,</p>
<div class="math">
\[\begin{split}\begin{align}
\begin{pmatrix}
b_1 &amp; c_1   &amp;        &amp;       &amp; 0   \\
a_2 &amp; 1+(1-\theta)r_b    &amp; (1-\theta)r_c    &amp;       &amp;     \\
    &amp; \ddots &amp; \ddots &amp; \ddots&amp;     \\
    &amp;        &amp;  (1-\theta)r_a   &amp; 1+(1-\theta)r_b   &amp; c_{J-1} \\
 0  &amp;        &amp;        &amp; a_J  &amp; b_J
\end{pmatrix}
\begin{pmatrix}
    w_1^n \\
    w_2^n \\
    \vdots \\
    w_{J-1}^n \\
    w_J^n \\
\end{pmatrix} + k
\begin{pmatrix}
    s_1^n \\
    s_2^n \\
    \vdots \\
    s_{J-1}^n \\
    s_J^n\\
\end{pmatrix} +
\begin{pmatrix}
    c_1 \\ %k g_R(x_L)/h_1 \\
    c_2 \\%0 \\
    \vdots \\
    c_{J-1} \\%0 \\
    c_{J} \\%-k g_R(x_R)/h_J\\
\end{pmatrix}
\end{align}\end{split}\]</div>
<p>Notice the terms in the top-left and bottom-right corners of the matrices have been modified, these are the terms that need to be changed to implement the boundary conditions. In addition to altering the matrix equation, a new vector as been introduced on the right hand side which carrier the boundary condition values.</p>
</div>
<div class="section" id="implementing-robin-boundary-conditions">
<h2>Implementing Robin boundary conditions<a class="headerlink" href="#implementing-robin-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>To implement Robin boundary conditions the terms belonging to <span class="math">\(\boldsymbol{A}\)</span> become the following,</p>
<div class="math">
\[\begin{split}\begin{align}
b_1 &amp; = 1 - \theta \frac{k}{h_1}\left( -\frac{a(x_{3/2})h_2}{2h_{+}} - \frac{d(x_{3/2})}{h_{+}} \right) \\
c_1 &amp; = - \theta \frac{k}{h_1}\left( -\frac{a(x_{3/2})h_1}{2h_{+}} + \frac{d(x_{3/2})}{h_{+}} \right) \\
a_2 &amp; = -\theta r_a \\
c_{J-1} &amp; = -\theta r_c \\
a_J &amp; = -\theta \frac{k}{h_J}\left( \frac{a(x_{J-1/2})h_J}{2h_{-}} + \frac{d(x_{J-1/2})}{h_{-}} \right) \\
b_J &amp; = 1-\theta \frac{k}{h_J}\left( \frac{a(x_{J-1/2})h_{J-1}}{2h_{-}} - \frac{d(x_{J-1/2})}{h_{-}} \right) \\
\end{align}\end{split}\]</div>
<p>The terms belonging to <span class="math">\(\boldsymbol{M}\)</span> become the following,</p>
<div class="math">
\[\begin{split}\begin{align}
b_1 &amp; = 1 + (1 - \theta) \frac{k}{h_1}\left( -\frac{a(x_{3/2})h_2}{2h_{+}} - \frac{d(x_{3/2})}{h_{+}} \right) \\
c_1 &amp; = (1 - \theta)\frac{k}{h_1}\left( -\frac{a(x_{3/2})h_1}{2h_{+}} + \frac{d(x_{3/2})}{h_{+}} \right) \\
a_2 &amp; = (1 - \theta) r_a \\
c_{J-1} &amp; = (1 - \theta) r_c \\
a_J &amp; = (1 - \theta)\frac{k}{h_J}\left( \frac{a(x_{J-1/2})h_J}{2h_{-}} + \frac{d(x_{J-1/2})}{h_{-}} \right) \\
b_J &amp; = 1 + (1 - \theta) \frac{k}{h_J}\left( \frac{a(x_{J-1/2})h_{J-1}}{2h_{-}} - \frac{d(x_{J-1/2})}{h_{-}} \right) \\
\end{align}\end{split}\]</div>
<p>The elements of the boundary condition vector are all zero with the following exception,</p>
<div class="math">
\[\begin{split}c_1 = k\frac{g_D(x_{L})}{h_1} \\
c_J = k\frac{g_D(x_{R})}{h_J}\end{split}\]</div>
</div>
<div class="section" id="implementing-dirichlet-boundary-conditions">
<h2>Implementing Dirichlet boundary conditions<a class="headerlink" href="#implementing-dirichlet-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>To implement Dirichlet boundary conditions the terms belonging to <span class="math">\(A\)</span> become the following,</p>
<div class="math">
\[\begin{split}\begin{align}
b_1 &amp; = 1 \\
c_1 &amp; = 0 \\
a_2 &amp; = 0 \\
c_{J-1} &amp; = 0\\
a_J &amp; = 0 \\
b_J &amp; = 1 \\
\end{align}\end{split}\]</div>
<p>The terms belonging to <span class="math">\(M\)</span> become the following,</p>
<div class="math">
\[\begin{split}\begin{align}
b_1 &amp; = 0 \\
c_1 &amp; = 0 \\
a_2 &amp; = 0 \\
c_{J-1} &amp; = 0\\
a_J &amp; = 0 \\
b_J &amp; = 0 \\
\end{align}\end{split}\]</div>
<p>The elements of the boundary condition vector are all zero with the exception of the following elements,</p>
<div class="math">
\[\begin{split}\begin{align}
c_1 &amp; = g_D(x_{L}) \\
c_J &amp; = r_a g_D(x_{L}) \\
c_{J-1} &amp; = r_c g_D(x_{R}) \\
c_J &amp; = g_D(x_{R}) \\
\end{align}\end{split}\]</div>
<p><strong>NB</strong> it is <em>not</em> an error that the time step is <em>not</em> included in the boundary condition vector.</p>
<div class="section" id="aside-linear-interpolation-between-cell-centre-and-face-values">
<h3>Aside <span class="math">\(-\)</span> Linear interpolation between cell centre and face values<a class="headerlink" href="#aside-linear-interpolation-between-cell-centre-and-face-values" title="Permalink to this headline">¶</a></h3>
<p>In general, linear interpolation between two points <span class="math">\((x_0, x_1)\)</span> can be used to find the value of a function at <span class="math">\(f(x)\)</span>,</p>
<div class="math">
\[f(x) = \frac{x - x_1}{x_0 - x_1}f(x_0) + \frac{x - x_0}{x_1 - x_0}f(x_1)\]</div>
<p>In a cell centred grid we know the value of the variable <span class="math">\(w\)</span> at difference points, <span class="math">\(w_j\)</span> and <span class="math">\(w_{j+1}\)</span>. We can apply the linear interpolation formulae above to determine value at cell face <span class="math">\(w_{j+1/2}\)</span>.</p>
<div class="math">
\[w_{j+1/2} =  \frac{x_{j+1/2} - x_{j+1}}{x_{j} - x_{j+1}} w_j + \frac{x_{j+1/2} - x_j}{x_{j+1} - x_j} w_{j+1}\]</div>
<p>This can be simplified firstly by using function to represent the distance between cell centres,</p>
<div class="math">
\[h_{-} = x_j - x_{j-1} \quad h_{+} = x_{j+1} - x_{j}\]</div>
<p>to give,</p>
<div class="math">
\[w_{j+1/2} = \frac{x_{j+1} - x_{j+1/2}}{h_{+}} w_j + \frac{x_{j+1/2} - x_j}{h_{+}} w_{j+1}\]</div>
<p>This expression still contains <span class="math">\(x_{j+1/2}\)</span> which we can simplify further by using an expression for the position of cell centres,</p>
<div class="math">
\[x_j = \frac{1}{2} \left( x_{j-\frac{1}{2}} + x_{j+\frac{1}{2}} \right) \quad x_{j+1} = \frac{1}{2} \left( x_{j+\frac{1}{2}} + x_{j+\frac{3}{2}} \right)\]</div>
<p>Note, this expression is still valid of non-uniform grids, it simply says that cell centres are always equidistant from two faces. Rearranging the above expression and substituting in for <span class="math">\(x_{j}\)</span> and <span class="math">\(x_{j+1}\)</span> terms gives,</p>
<div class="math">
\[w_{j+1/2} = \frac{\frac{1}{2} \left( x_{j+\frac{1}{2}} + x_{j+\frac{3}{2}} \right) - x_{j+1/2}}{h_{+}} w_j + \frac{x_{j+1/2} - \frac{1}{2} \left(       x_{j-\frac{1}{2}} + x_{j+\frac{1}{2}} \right)}{h_{+}} w_{j+1}\]</div>
<p>Finally, by defining the distance between vertices as, <span class="math">\(h_j = x_{j+\frac{1}{2}} - x_{j-\frac{1}{2}}\)</span>, we can simplify to the following expression,</p>
<div class="math">
\[w_{j+1/2} = \frac{h_{j+1}}{2h_{+}} w_j + \frac{h_j}{2h_{+}} w_{j+1}\]</div>
<p>Similarly the <span class="math">\(w_{j-1/2}\)</span> can be found,</p>
<div class="math">
\[w_{j-1/2} = \frac{h_{j}}{2h_{-}} w_{j-1} + \frac{h_{j-1}}{2h_{-}} w_{j}\]</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The finite volume method</a><ul>
<li><a class="reference internal" href="#adaptive-upwinding-exponential-fitting">Adaptive upwinding &amp; exponential fitting</a></li>
<li><a class="reference internal" href="#naturally-resolved-robin-boundary-conditions">Naturally resolved Robin boundary conditions</a></li>
<li><a class="reference internal" href="#the-method">The <span class="math">\(\theta\)</span>-method</a></li>
<li><a class="reference internal" href="#discretised-equation-in-matrix-form">Discretised equation in matrix form</a></li>
<li><a class="reference internal" href="#implementing-robin-boundary-conditions">Implementing Robin boundary conditions</a></li>
<li><a class="reference internal" href="#implementing-dirichlet-boundary-conditions">Implementing Dirichlet boundary conditions</a><ul>
<li><a class="reference internal" href="#aside-linear-interpolation-between-cell-centre-and-face-values">Aside <span class="math">\(-\)</span> Linear interpolation between cell centre and face values</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Notes on implemented the finite-volume method for the advection-diffusion equation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/finite_volume_method.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="Notes on implemented the finite-volume method for the advection-diffusion equation"
             >previous</a> |</li>
        <li><a href="index.html">FVM Docs 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Daniel J Farrell.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>